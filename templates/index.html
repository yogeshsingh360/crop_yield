<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crop Yield Prediction</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f4f4f4;
            margin: 20px;
        }
        .container {
            width: 50%;
            margin: auto;
            padding: 20px;
            background: white;
            border-radius: 5px;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
        }
        input, button {
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        button {
            background-color: #28a745;
            color: white;
            cursor: pointer;
        }
        .input-container {
            position: relative;
        }
        .autocomplete-list {
            border: 1px solid #ccc;
            background: white;
            position: absolute;
            width: 100%;
            max-height: 150px;
            overflow-y: auto;
            display: none;
            text-align: left;
            z-index: 1000;
            box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
        }
        .autocomplete-item {
            padding: 10px;
            cursor: pointer;
        }
        .autocomplete-item:hover {
            background: #f0f0f0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>Crop Yield Prediction</h2>
        <form id="prediction-form" action="predict" method="post">
            <input type="number" id="year" name="Crop_Year" placeholder="Enter Year" min="1900" max="3050">
            
            <div class="input-container">
                <input type="text" id="crop" name="Crop" placeholder="Crop" onkeyup="showSuggestions(this, 'crop-list', window.cropList)">
                <div id="crop-list" class="autocomplete-list"></div>
            </div>
            
            <div class="input-container">
                <input type="text" id="season" name="Season" placeholder="Season" onkeyup="showSuggestions(this, 'season-list', window.seasonList)">
                <div id="season-list" class="autocomplete-list"></div>
            </div>
            
            <div class="input-container">
                <input type="text" id="state" name="State" placeholder="State" onkeyup="showSuggestions(this, 'state-list', window.stateList)">
                <div id="state-list" class="autocomplete-list"></div>
            </div>
            
            <div class="input-container">
                <input type="text" id="soil_condition" name="Soil_Condition" placeholder="Soil Condition" onkeyup="showSuggestions(this, 'soil-list', window.soilList)">
                <div id="soil-list" class="autocomplete-list"></div>
            </div>
            
            <input type="number" name="Annual_Rainfall" placeholder="Annual Rainfall (mm)">
            <input type="number" name="Fertilizer" placeholder="Fertilizer (kg/ha)">
            <input type="number" name="Pesticide" placeholder="Pesticide (kg/ha)">
            <input type="number" name="Nitrogen (N) (kg/ha)" placeholder="Nitrogen (N) (kg/ha)">
            <input type="number" name="Phosphorus (P) (kg/ha)" placeholder="Phosphorus (P) (kg/ha)">
            <input type="number" name="Potassium (K) (kg/ha)" placeholder="Potassium (K) (kg/ha)">
            <input type="number" name="Area" placeholder="Area (ha)">
            <button type="submit">Predict Yield</button>
        </form>
        {% if prediction is not none %}
            <div class="output">
                <h3>Predicted Yield: {{ prediction|round(2) }} tons/ha</h3>
                <h3>Estimated Production: {{ production|round(2) }} tons</h3>
            </div>
        {% endif %}
        <p id="result"></p>
    </div>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            window.cropList = ["Arecanut", "Arhar/Tur", "Castor seed", "Cotton(lint)", "Dry chillies", "Gram", "Jute", "Linseed", "Maize", "Mesta", "Niger seed", "Onion", "Other Rabi pulses", "Potato", "Rapeseed & Mustard", "Rice", "Sesamum", "Small millets", "Sugarcane", "Sweet potato", "Tapioca", "Tobacco", "Turmeric", "Wheat", "Bajra", "Black pepper", "Cardamom", "Coriander", "Garlic", "Ginger", "Groundnut", "Horse-gram", "Jowar", "Ragi", "Cashewnut", "Banana", "Soyabean", "Barley", "Khesari", "Masoor", "Moong(Green Gram)", "Other Kharif pulses", "Safflower", "Sannhamp", "Sunflower", "Urad", "Peas & beans (Pulses)", "Other oilseeds", "Other Cereals", "Cowpea(Lobia)", "Oilseeds total", "Guar seed", "Other Summer Pulses", "Moth", "Coconut"];
            window.seasonList = ['Whole Year', 'Kharif', 'Rabi', 'Autumn', 'Summer', 'Winter'];
            window.stateList = ['Assam', 'Karnataka', 'Kerala', 'Meghalaya', 'West Bengal', 'Puducherry', 'Goa', 'Andhra Pradesh', 'Tamil Nadu', 'Odisha', 'Bihar', 'Gujarat', 'Madhya Pradesh', 'Maharashtra', 'Mizoram', 'Punjab', 'Uttar Pradesh', 'Haryana', 'Himachal Pradesh', 'Tripura', 'Nagaland', 'Chhattisgarh', 'Uttarakhand', 'Jharkhand', 'Delhi', 'Manipur', 'Jammu and Kashmir', 'Telangana', 'Arunachal Pradesh', 'Sikkim'];
            window.soilList = ['Alluvial Soil', 'Red Soil', 'General Agricultural Soil', 'Black Soil', 'Desert Soil', 'Laterite Soil'];

            window.showSuggestions = (inputElement, listId, list) => {
                const listDiv = document.getElementById(listId);
                listDiv.innerHTML = "";
                const inputValue = inputElement.value.trim();
                
                if (inputValue.length === 0) {
                    listDiv.style.display = "none";
                    return;
                }

                const filteredList = list.filter(item => item.toLowerCase().includes(inputValue.toLowerCase()));

                if (filteredList.length > 0) {
                    listDiv.style.display = "block";
                    listDiv.innerHTML = filteredList.map(item => 
                        `<div class='autocomplete-item' onclick='selectItem("${inputElement.id}", "${item}")'>${item}</div>`
                    ).join("");
                } else {
                    listDiv.style.display = "none";
                }
            };

            window.selectItem = (inputId, value) => {
                document.getElementById(inputId).value = value;
                document.getElementById(inputId + "-list").style.display = "none";
            };

            document.addEventListener("click", (event) => {
                if (!event.target.closest(".input-container")) {
                    document.querySelectorAll(".autocomplete-list").forEach(list => list.style.display = "none");
                }
            });
        });
    </script>
</body>
</html>

